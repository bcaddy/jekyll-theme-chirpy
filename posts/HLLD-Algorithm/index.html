<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HLLD Algorithm" /><meta name="author" content="Robert Caddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://robertcaddy.com/posts/HLLD-Algorithm/" /><meta property="og:url" content="https://robertcaddy.com/posts/HLLD-Algorithm/" /><meta property="og:site_name" content="Robert ‘Bob’ Caddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-23T16:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HLLD Algorithm" /> <script type="application/ld+json"> {"datePublished":"2020-10-23T16:00:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://robertcaddy.com/posts/HLLD-Algorithm/"},"description":"Overview","url":"https://robertcaddy.com/posts/HLLD-Algorithm/","@type":"BlogPosting","author":{"@type":"Person","name":"Robert Caddy"},"headline":"HLLD Algorithm","dateModified":"2020-10-23T16:00:00-04:00","@context":"https://schema.org"}</script><title>HLLD Algorithm | Robert 'Bob' Caddy</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Robert 'Bob' Caddy"><meta name="application-name" content="Robert 'Bob' Caddy"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/icons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Robert 'Bob' Caddy</a></div><div class="site-subtitle font-italic">Ph.D Candidate, Third Year University of Pittsburgh</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-satellite-dish ml-xl-3 mr-xl-3 unloaded"></i> <span>RESEARCH BLOG</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/research/" class="nav-link"> <i class="fa-fw fas fa-flask ml-xl-3 mr-xl-3 unloaded"></i> <span>RESEARCH</span> </a><li class="nav-item"> <a href="/community-and-outreach/" class="nav-link"> <i class="fa-fw fas fa-users ml-xl-3 mr-xl-3 unloaded"></i> <span>COMMUNITY OUTREACH</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fas fa-envelope ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a><li class="nav-item"> <a href="/cv/" class="nav-link"> <i class="fa-fw fas fa-scroll ml-xl-3 mr-xl-3 unloaded"></i> <span>CURRICULUM VITAE</span> </a><li class="nav-item"> <a href="/resume/" class="nav-link"> <i class="fa-fw fas fa-scroll ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/bcaddy" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['r.caddy','pitt.edu'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/robertcaddy1/" aria-label="linkedin" class="order-5" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>HLLD Algorithm</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HLLD Algorithm</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Robert Caddy </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Oct 23, 2020, 4:00 PM -0400" prep="on" > Oct 23, 2020 <i class="unloaded">2020-10-23T16:00:00-04:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1696 words">9 min</span></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This is a step through of the HLLD Riemann solver I’m going to add to my <a href="https://github.com/bcaddy/hydro-sandbox">hydro-sandbox</a> code. The specific algorithm is from <a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano 2005</a> which is the original paper where the HLLD Riemann solver was introduced. This will serve as practice and figuring out any kinks before I add the HLLD solver (along with <a href="https://www.sciencedirect.com/science/article/abs/pii/S1384107608000754?via%3Dihub">VL+CT</a>) to <a href="https://github.com/cholla-hydro/cholla">Cholla</a>.</p><p>Overall the algorithm is very similar to the HLLC algorithm detailed in my <a href="/posts/HLLC-Algorithm/">earlier post on the topic</a>. However a lot of the details have changed; for example instead of the sound speed \( c \) we must now compute the speed of either the fast or slow magnetosonic wave \( c_{f,s} \). Similar small changes are common so be careful not to miss them. Note that the HLLD Riemann solver does not include all 7 MHD waves; It ignores the slow magnetosonic wave.</p><h2 id="glossary-of-symbols">Glossary of Symbols</h2><p>Note: since magnetic fields are inherently 3D due to the use of the outproduct even the 1D algorithm I write out here uses all three dimensions. The first dimension is always in the \( x \) direction however, again because of the cross product, the active elements of the magnetic field are in the \( y \) and \( z \) directions.</p><ul><li>\(k \), Subscript to indicate left or right. i.e. \( k = L \ \text{or}\ R \)<li>\(j \), Subscript to indicate which dimension we’re using. i.e. \( i = x, y, \text{or}\; z \)<li>\(* \), Superscript that indicates if the variable is the value within the star region, ie the region between the fast magnetosonic waves and the Alfvén waves.<li>\(** \), Superscript that indicates if the variable is the value within the star region, ie the region between the Alfvén waves and the contact discontinuity.<li>\( \vec{F} \), Flux<li>\(\rho \), Density<li>\(p \), Pressure<li>\(E \), Energy<li>\(v \), Velocity<li>\(B \), Magnetic Field<li>\(p_T \), Total pressure<li>\(S_L \), Approximation of the speed of the left moving magnetosonic wave<li>\(S_L^* \), Approximation of the speed of the left moving Alfvên wave<li>\(S_M \), Approximation of the speed of the center (contact) wave speed<li>\(S_R \), Approximation of the speed of the right moving magnetosonic wave<li>\(S_R^* \), Approximation of the speed of the right moving Alfvên wave<li>\(c \), Sound speed<li>\(\vec{U} \), Vector of conserved variables</ul><h2 id="glossary-of-new-equations">Glossary of New Equations</h2><p>MHD comes along with many modifications to the various basic equations that we’re used to; new terms in the pressure and energy equations, new wave speeds, new eigenvalues etc. I summarize the ones I plan to use here.</p><h3 id="conservative-variable-vector-and-flux">Conservative Variable Vector and Flux</h3>\[\vec{U}_k = \begin{bmatrix} \rho_k \\ \rho_k v_{x,k} \\ \rho_k v_{y,k} \\ \rho_k v_{z,k} \\ B_x \\ B_y \\ B_z \\ E \end{bmatrix} \text{,}\; \; \vec{F}_k = \begin{bmatrix} \rho_k v_{x,k} \\ \rho_k v_{x,k}^2 + p_{T,k} - B_{x,k}^2 \\ \rho v_{x,k} v_{y,k} - B_{x,k} B_{y,k} \\ \rho v_{x,k} v_{z,k} - B_{x,k} B_{z,k} \\ 0 \\ B_{y,k} v_{x,k} - B_{x,k} v_{y,k} \\ B_{z,k} v_{x,k} - B_{x,k} v_{z,k} \\ v_{x,k} \left( E_k + p_{T,k} \right) - B_{x,k} \left( \vec{v_k} \cdot \vec{B_k} \right) \end{bmatrix}\]<h3 id="eigenvalues">Eigenvalues:</h3>\[\lambda_{2,6} = v_x \mp c_a, \; \lambda_{1,7} = v_x \mp c_f, \; \lambda_{3,5} = v_x \mp c_s, \; \lambda_{4} = v_x\]<h3 id="alfvên-wave-speed">Alfvên Wave Speed:</h3>\[c_a = \frac{\mid B_x \mid}{\sqrt{\rho}}\]<h3 id="fast--slow-magnetosonic-wavespeeds">Fast &amp; Slow Magnetosonic Wavespeeds:</h3>\[c_{f,s} = \sqrt{\frac {\gamma p + \mid \vec{B} \mid^2 \pm \sqrt{\left( \gamma p \;+ \mid \vec{B} \mid^2 \right)^2 - 4\gamma p B_x^2 } } {2\rho}}\]<h3 id="pressure">Pressure:</h3>\[p = \left( \gamma - 1 \right) \left( E - \frac{1}{2} \rho \mid \vec{v}\mid ^2 - \frac{1}{2} \mid \vec{B} \mid ^2 \right)\] \[p_T = p_{Total} = p + \frac{1}{2} \mid \vec{B} \mid ^2\]<h3 id="energy">Energy:</h3>\[E = \frac{p}{\gamma - 1} + \frac{1}{2}\left( \rho \mid \vec{v} \mid ^2 + \mid \vec{B} \mid ^2\right) = \frac{p_T - \frac{1}{2}\mid \vec{B} \mid^2 }{\gamma - 1} + \frac{1}{2}\left( \rho \mid \vec{v} \mid ^2 + \mid \vec{B} \mid ^2\right)\]<h3 id="which-variables-are-the-same-between-states">Which Variables are the Same Between States:</h3>\[S_M = v_{x,L}^* = v_{x,L}^{**} = v_{x,R}^* = v_{x,R}^{**}\] \[p_T^* = p_{T_L}^* = p_{T_L}^{**} = p_{T_R}^* = p_{T_R}^{**}\] \[\rho_k^* = \rho_k^{**}\] \[\vec{v}_R^{**} = \vec{v}_L^{**} = \vec{v}^{**} \text{if}\; B_x = 0\] \[\vec{B}_R^{**} = \vec{B}_L^{**} = \vec{B}^{**}\; \text{if}\; B_x = 0\]<h1 id="algorithm">Algorithm</h1><p>Our goal is to choose the correct HLLD flux depending on the interface states.</p><h2 id="1-compute-acoustic--contact-wave-speeds">1. Compute Acoustic &amp; Contact Wave Speeds</h2><p>First we need to compute \( S_L, S_L^*, S_M, S_R^*, \text{and} S_R \) using the below equations.</p><h3 id="computing--s_l--and--s_r-">Computing \( S_L \) and \( S_R \)</h3><p>We can use either of the below approximations for \( S_L \text{and} S_R \) (there are other options as well, these were just the two given in <a href="https://www.sciencedirect.com/science/article/pii/S0021999105001142?via%3Dihub">Miyoshi &amp; Kusano 2005</a>)</p>\[S_L = \min(\lambda_{min}(\vec{U}_L), \lambda_{min}(\vec{U}_R))\] \[S_R = \max(\lambda_{max}(\vec{U}_L), \lambda_{max}(\vec{U}_R))\]<p>Where \( \lambda_{min} \) is the smallest eigenvalue and \( \lambda_{max} \) is the largest.</p><p><strong>OR</strong></p>\[S_L = \min(v_{x,L}, v_{x,R}) - \max(c_{f,L}, c_{f,R})\] \[S_R = \max(v_{x,L}, v_{x,R}) + \max(c_{f,L}, c_{f,R})\]<h3 id="computing--s_l--and--s_r--1">Computing \( S_L^* \) and \( S_R^* \)</h3>\[S_L^* = S_M - \frac{\mid B_x \mid}{\sqrt{\rho_L^*}}\] \[S_R^* = S_M + \frac{\mid B_x \mid}{\sqrt{\rho_R^*}}\]<p>where</p>\[\rho_k^* = \rho_k \frac{S_k - v_{x,k}}{S_k - S_M}\]<h3 id="computing--s_m-">Computing \( S_M \)</h3>\[S_M = \frac {\rho_R v_{x,R} \left( S_R - v_{x,R}\right) - \rho_L v_{x,L} \left( S_L - v_{x,L}\right) + p_{T_L} - p_{T_R}} {\rho_R \left( S_R - v_{x,R}\right) - \rho_L \left( S_L - v_{x,L}\right)}\]<h2 id="2-determine-which-state-were-in">2. Determine Which State We’re In</h2><p>Use the equation below with the wave speeds to determine which state we’re in. If we’re in a non-star state go to step 3a, for star states go to step 3b, and for double star states go to step 3c.</p>\[\vec{F}_{HLLC} = \begin{cases} \vec{F}_L &amp; \text{if}\ 0 &lt; S_L \\ \\ \vec{F}_L^* &amp; \text{if}\ S_L \leq 0 &lt; S_L^* \\ \\ \vec{F}_L^{**} &amp; \text{if}\ S_L^* \leq 0 &lt; S_M \\ \\ \vec{F}_R^{**} &amp; \text{if}\ S_M \leq 0 &lt; S_R^* \\ \\ \vec{F}_R^* &amp; \text{if}\ S_R^* \leq 0 \leq S_R \\ \\ \vec{F}_R &amp; \text{if}\ S_R &lt; 0 \end{cases}\]<h2 id="3-compute--return-the-fluxes">3. Compute &amp; Return the Fluxes</h2><h3 id="3a--f_l--or--f_r--state">3a. \( F_L \) or \( F_R \) State</h3><p>This is the region outside of either magnetosonic wave. The flux is easy, simply compute fluxes with the below equation and return.</p>\[\vec{F}_k = \begin{bmatrix} \rho_k v_{x,k} \\ \rho_k v_{x,k}^2 + p_{T,k} - B_{x,k}^2 \\ \rho v_{x,k} v_{y,k} - B_{x,k} B_{y,k} \\ \rho v_{x,k} v_{z,k} - B_{x,k} B_{z,k} \\ 0 \\ B_{y,k} v_{x,k} - B_{x,k} v_{y,k} \\ B_{z,k} v_{x,k} - B_{x,k} v_{z,k} \\ v_{x,k} \left( E_k + p_{T,k} \right) - B_{x,k} \left( \vec{v_k} \cdot \vec{B_k} \right) \end{bmatrix}\]<h3 id="3b--f_l--or--f_r--state">3b. \( F_L^* \) or \( F_R^* \) State</h3><p>This is the region between the fast magnetosonic waves and the Alfvên waves. These fluxes are more complicated and require the use of the fluxes from step 3a as well. The algorithm is exactly the same for the left and right star states so the subscript \( k \) is used to indicate \( R \) or \( L \).</p>\[\vec{F}_k^* = \vec{F}_k + S_k \left( \vec{U}_k^* - \vec{U}_k \right)\]<p>and we find the components of \(\vec{U}_k^* \) with the following equations. \( \rho^*_k \) was already computed when finding \( S_k^* \) and \( v_{x,k}^* = S_M \)</p>\[p_T^* = \frac { \rho_R p_{T_L} \left( S_R - v_{x,R} \right) - \rho_L p_{T_R} \left( S_L - v_{x,L} \right) + \rho_L \rho_R \left( S_R - v_{x,R} \right) \left( S_L - v_{x,L} \right) \left( v_{x,R} - v_{x,L} \right) } {\rho_R \left( S_R - v_{x,R} \right) - \rho_L \left( S_L - v_{x,L} \right)}\] \[E_k^* = \frac { E_k \left( S_k - v_{x,k} \right) - p_{T,k} v_{x,k} + p_T^* S_M + B_x \left( \vec{v}_k \cdot \vec{B}_k - \vec{v}_k^* \cdot \vec{B}_k^* \right) } {S_k - S_M}\]<p>We can find the \( y \) and \( z \) components of \( \vec{v} \) and \(\vec{B} \) with the follwing equations. Note these equations can give a term that is \( \frac{0}{0} \) if \( S_M = v_{x,k}\), \(S_k = v_{x,k} \pm c_{f,k}\), \(B_{y,k} = B_{z,k} = 0\), and \(B_x^2 \ge \gamma p_k \). If this is the case then there is no shock across \( S_k \), so set \( \vec{v}_k^* = \vec{v}_k\), \(B_{y,k} = B_{z,k} = 0\), \(\rho_k^* = \rho_k\), and \( p_{T,k}^* = p_{T,k} \).</p>\[v_{j,k}^* = v_{j,k} - B_x B_{j,k} \frac {S_M - v_{x,k}} {\rho_k \left( S_k - v_{x,k} \right) \left( S_k - S_M \right) - B_x^2 }\] \[B_{j,k}^* = B_{j,k} \frac {\rho_k \left( S_k - v_{x,k} \right)^2 - B_x^2 } {\rho_k \left( S_k - v_{x,k} \right) \left( S_k - S_M \right) - B_x^2 }\]<p>Note that the denominators are the same</p><h3 id="3c--f_l--or--f_r--state">3c. \( F_L^{**} \) or \( F_R^{**} \) State</h3><p>This is the region between the Alfvên waves and the contact discontinuity (entropy wave). These fluxes require the fluxes from step 3a and 3b. The algorithm is exactly the same for the left and right star states so the subscript \( k \) is used to indicate \( R \) or \( L \).</p>\[\vec{F}_k^{**} = \vec{F}_k^* + S_k^{**} \left( \vec{U}_k^{**} - \vec{U}_k^* \right)\]<p>We already know some of the state variables from previous computations</p>\[v_{x,k}^{**} = S_M\] \[p_T^{**} = p_T^{*}\] \[\rho_k^{**} = \rho_k^*\]<p>So all we need to compute directly is \( \; v_y^{**} \), \( \; v_z^{**} \), \( \; B_y^{**} \), \( \; B_z^{**} \), and \( \; E_k^{**} \)</p>\[v_j^{**} = \frac { v_L^* \sqrt{\rho_L^*} + v_R^* \sqrt{\rho_R^*} + \left( B_{j,R}^* - B_{j,L}^* \right) \text{sign}\left( B_x \right) } {\sqrt{\rho_L^*} + \sqrt{\rho_R^*}}\] \[B_j^{**} = \frac { B_{j,R}^* \sqrt{\rho_L^*} + B_{j,L}^* \sqrt{\rho_R^*} + \left( v_{j,R}^* - v_{j,L}^* \right) \sqrt{\rho_L^* \rho_R^*} \text{sign}\left( B_x \right) } {\sqrt{\rho_L^*} + \sqrt{\rho_R^*}}\]<p>Note that the denominators are the same as is one of the coefficients in each term in the numerator.</p><p>Lastly we compute the energy (the minus and plus correspond to the L and R side respectively)</p>\[E_k^{**} = E_k^* \mp \sqrt{\rho_k^*} \left( \vec{v}_k^* \cdot \vec{B}_k^* - \vec{v}_k^{**} \cdot \vec{B}_k^{**} \right) \text{sign}\left( B_x \right)\]<h1 id="conclusion">Conclusion</h1><p>And that’s it. We’re done! As you can see the HLLD solver is significantly more complex than the HLLC solver to account for the extra waves. Note that many of the star state primitive variables are used in a bunch of different places so assigning them to member variables is probably a good idea if you’re implementing this as a class.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/mhd/'>MHD</a>, <a href='/categories/riemann-solvers/'>Riemann Solvers</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hlld/" class="post-tag no-text-decoration" >HLLD</a> <a href="/tags/hllc/" class="post-tag no-text-decoration" >HLLC</a> <a href="/tags/mhd/" class="post-tag no-text-decoration" >MHD</a> <a href="/tags/hydro/" class="post-tag no-text-decoration" >Hydro</a> <a href="/tags/computational-methods/" class="post-tag no-text-decoration" >Computational Methods</a> <a href="/tags/numerical-methods/" class="post-tag no-text-decoration" >Numerical Methods</a> <a href="/tags/riemann-solver/" class="post-tag no-text-decoration" >Riemann Solver</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HLLD Algorithm - Robert 'Bob' Caddy&url=https://robertcaddy.com/posts/HLLD-Algorithm/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HLLD Algorithm - Robert 'Bob' Caddy&u=https://robertcaddy.com/posts/HLLD-Algorithm/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HLLD Algorithm - Robert 'Bob' Caddy&url=https://robertcaddy.com/posts/HLLD-Algorithm/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/VL+CT-Algorithm/">VL+CT Algorithm</a><li><a href="/posts/Classes-and-bugfixing-6/">Classes and Bugfixing 6</a><li><a href="/posts/Research-So-Far/">Research So Far</a><li><a href="/posts/Van-Leer-and-HLLC/">Van Leer and HLLC</a><li><a href="/posts/Finished-Van-Leer/">Van Leer & HLLC Part 2</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/astronomical-techniques/">Astronomical Techniques</a> <a class="post-tag" href="/tags/riemann-solver/">Riemann Solver</a> <a class="post-tag" href="/tags/constrained-transport/">Constrained Transport</a> <a class="post-tag" href="/tags/general-relativity/">General Relativity</a> <a class="post-tag" href="/tags/bugs/">Bugs</a> <a class="post-tag" href="/tags/hlld/">HLLD</a> <a class="post-tag" href="/tags/mhd/">MHD</a> <a class="post-tag" href="/tags/computational-methods/">Computational Methods</a> <a class="post-tag" href="/tags/hydro/">Hydro</a> <a class="post-tag" href="/tags/numerical-methods/">Numerical Methods</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HLLC-Algorithm/"><div class="card-body"> <span class="timeago small" > Oct 8, 2020 <i class="unloaded">2020-10-08T17:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HLLC Algorithm</h3><div class="text-muted small"><p> Overview This is a step through of the particular HLLC Riemann solver I’m going to add to my hydro-sandbox code. It will serve as a base and teaching tool for my future implementation of an HLLD M...</p></div></div></a></div><div class="card"> <a href="/posts/VL+CT-Algorithm/"><div class="card-body"> <span class="timeago small" > Jan 6 <i class="unloaded">2021-01-06T14:44:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>VL+CT Algorithm</h3><div class="text-muted small"><p> Overview This is a step through of the VL+CT (Van Leer plus Constrained Transport) integrator I’m going to add to my hydro-sandbox code. The specific algorithm is from Stone &amp; Gardiner 2009 wh...</p></div></div></a></div><div class="card"> <a href="/posts/Research-So-Far/"><div class="card-body"> <span class="timeago small" > Aug 31, 2020 <i class="unloaded">2020-08-31T11:12:26-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Research So Far</h3><div class="text-muted small"><p> Overview This is my first post so I’m going to summarize what I’ve done this year and what my plans are for the near future. I spent the spring semester mostly taking taking classes. When I had t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HLLC-Implementation/" class="btn btn-outline-primary" prompt="Older"><p>HLLC Implementation</p></a> <a href="/posts/Starting-HLLD/" class="btn btn-outline-primary" prompt="Newer"><p>Starting On HLLD Riemann Solver</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/bcaddy">Robert Caddy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/astronomical-techniques/">Astronomical Techniques</a> <a class="post-tag" href="/tags/riemann-solver/">Riemann Solver</a> <a class="post-tag" href="/tags/constrained-transport/">Constrained Transport</a> <a class="post-tag" href="/tags/general-relativity/">General Relativity</a> <a class="post-tag" href="/tags/bugs/">Bugs</a> <a class="post-tag" href="/tags/hlld/">HLLD</a> <a class="post-tag" href="/tags/mhd/">MHD</a> <a class="post-tag" href="/tags/computational-methods/">Computational Methods</a> <a class="post-tag" href="/tags/hydro/">Hydro</a> <a class="post-tag" href="/tags/numerical-methods/">Numerical Methods</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://robertcaddy.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
